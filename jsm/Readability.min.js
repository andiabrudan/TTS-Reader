function ta(a,b,c){c=c||{},this._uri=a,this._doc=b,this._biggestFrame=!1,this._articleTitle=null,this._articleByline=null,this._articleDir=null,this._debug=!!c.debug,this._maxElemsToParse=c.maxElemsToParse||this.DEFAULT_MAX_ELEMS_TO_PARSE,this._nbTopCandidates=c.nbTopCandidates||this.DEFAULT_N_TOP_CANDIDATES,this._maxPages=c.maxPages||this.DEFAULT_MAX_PAGES,this._flags=this.FLAG_STRIP_UNLIKELYS|this.FLAG_WEIGHT_CLASSES|this.FLAG_CLEAN_CONDITIONALLY,this._parsedPages={},this._pageETags={},this._curPageNum=1;var d;this._debug?(d=function(a){var b=a.nodeName+" ";if(a.nodeType==a.TEXT_NODE)return b+'("'+a.textContent+'")';var c=a.className&&"."+a.className.replace(/ /g,"."),d="";return a.id?d="(#"+a.id+c+")":c&&(d="("+c+")"),b+d},this.log=function(){if("undefined"!=typeof dump){var a=Array.prototype.map.call(arguments,function(a){return a&&a.nodeName?d(a):a}).join(" ");dump("Reader: (Readability) "+a+"\n")}else if("undefined"!=typeof console){["Reader: (Readability) "].concat(arguments)}}):this.log=function(){}}ta.prototype={FLAG_STRIP_UNLIKELYS:1,FLAG_WEIGHT_CLASSES:2,FLAG_CLEAN_CONDITIONALLY:4,DEFAULT_MAX_ELEMS_TO_PARSE:0,DEFAULT_N_TOP_CANDIDATES:5,DEFAULT_MAX_PAGES:1,DEFAULT_TAGS_TO_SCORE:"section,h2,h3,h4,h5,h6,p,td,pre".toUpperCase().split(","),REGEXPS:{unlikelyCandidates:/banner|breadcrumbs|combx|comment|community|cover-wrap|disqus|extra|foot|header|legends|menu|modal|related|remark|replies|rss|shoutbox|sidebar|skyscraper|social|sponsor|supplemental|ad-break|agegate|pagination|pager|popup|yom-remote/i,okMaybeItsACandidate:/and|article|body|column|main|shadow/i,positive:/article|body|content|entry|hentry|h-entry|main|page|pagination|post|text|blog|story/i,negative:/hidden|^hid$| hid$| hid |^hid |banner|combx|comment|com-|contact|foot|footer|footnote|masthead|media|meta|modal|outbrain|promo|related|scroll|share|shoutbox|sidebar|skyscraper|sponsor|shopping|tags|tool|widget/i,extraneous:/print|archive|comment|discuss|e[\-]?mail|share|reply|all|login|sign|single|utility/i,byline:/byline|author|dateline|writtenby|p-author/i,replaceFonts:/<(\/?)font[^>]*>/gi,normalize:/\s{2,}/g,videos:/\/\/(www\.)?(dailymotion|youtube|youtube-nocookie|player\.vimeo)\.com/i,nextLink:/(next|weiter|continue|>([^\|]|$)|»([^\|]|$))/i,prevLink:/(prev|earl|old|new|<|«)/i,whitespace:/^\s*$/,hasContent:/\S$/},DIV_TO_P_ELEMS:["A","BLOCKQUOTE","DL","DIV","IMG","OL","P","PRE","TABLE","UL","SELECT"],ALTER_TO_DIV_EXCEPTIONS:["DIV","ARTICLE","SECTION","P"],_postProcessContent:function(a){this._fixRelativeUris(a)},_removeNodes:function(a,b){for(var c=a.length-1;c>=0;c--){var d=a[c],e=d.parentNode;e&&(b&&!b.call(this,d,c,a)||e.removeChild(d))}},_replaceNodeTags:function(a,b){for(var c=a.length-1;c>=0;c--){var d=a[c];this._setNodeTag(d,b)}},_forEachNode:function(a,b){Array.prototype.forEach.call(a,b,this)},_someNode:function(a,b){return Array.prototype.some.call(a,b,this)},_concatNodeLists:function(){var a=Array.prototype.slice,b=a.call(arguments),c=b.map(function(b){return a.call(b)});return Array.prototype.concat.apply([],c)},_getAllNodesWithTag:function(a,b){return a.querySelectorAll?a.querySelectorAll(b.join(",")):[].concat.apply([],b.map(function(b){var c=a.getElementsByTagName(b);return Array.isArray(c)?c:Array.from(c)}))},_fixRelativeUris:function(a){function b(a){return/^[a-zA-Z][a-zA-Z0-9\+\-\.]*:/.test(a)?a:"//"==a.substr(0,2)?c+"://"+a.substr(2):"/"==a[0]?d+a:0===a.indexOf("./")?e+a.slice(2):"#"==a[0]?a:e+a}var c=this._uri.scheme,d=this._uri.prePath,e=this._uri.pathBase,f=a.getElementsByTagName("a");this._forEachNode(f,function(a){var c=a.getAttribute("href");if(c)if(0===c.indexOf("javascript:")){var d=this._doc.createTextNode(a.textContent);a.parentNode.replaceChild(d,a)}else a.setAttribute("href",b(c))});var g=a.getElementsByTagName("img");this._forEachNode(g,function(a){var c=a.getAttribute("src");c&&a.setAttribute("src",b(c))})},_getArticleTitle:function(){function a(a){return a.split(/\s+/).length}var b=this._doc,c="",d="";try{c=d=b.title,"string"!=typeof c&&(c=d=this._getInnerText(b.getElementsByTagName("title")[0]))}catch(a){}var e=!1;if(/ [\|\-\\\/>»] /.test(c))e=/ [\\\/>»] /.test(c),c=d.replace(/(.*)[\|\-\\\/>»] .*/gi,"$1"),a(c)<3&&(c=d.replace(/[^\|\-\\\/>»]*[\|\-\\\/>»](.*)/gi,"$1"));else if(c.indexOf(": ")!==-1){var f=this._concatNodeLists(b.getElementsByTagName("h1"),b.getElementsByTagName("h2")),g=this._someNode(f,function(a){return a.textContent===c});g||(c=d.substring(d.lastIndexOf(":")+1),a(c)<3&&(c=d.substring(d.indexOf(":")+1)))}else if(c.length>150||c.length<15){var h=b.getElementsByTagName("h1");1===h.length&&(c=this._getInnerText(h[0]))}c=c.trim();var i=a(c);return i<=4&&(!e||i!=a(d.replace(/[\|\-\\\/>»]+/g,""))-1)&&(c=d),c},_prepDocument:function(){var a=this._doc;this._removeNodes(a.getElementsByTagName("style")),a.body&&this._replaceBrs(a.body),this._replaceNodeTags(a.getElementsByTagName("font"),"SPAN")},_nextElement:function(a){for(var b=a;b&&b.nodeType!=Node.ELEMENT_NODE&&this.REGEXPS.whitespace.test(b.textContent);)b=b.nextSibling;return b},_replaceBrs:function(a){this._forEachNode(this._getAllNodesWithTag(a,["br"]),function(a){for(var b=a.nextSibling,c=!1;(b=this._nextElement(b))&&"BR"==b.tagName;){c=!0;var d=b.nextSibling;b.parentNode.removeChild(b),b=d}if(c){var e=this._doc.createElement("p");for(a.parentNode.replaceChild(e,a),b=e.nextSibling;b;){if("BR"==b.tagName){var f=this._nextElement(b);if(f&&"BR"==f.tagName)break}var g=b.nextSibling;e.appendChild(b),b=g}}})},_setNodeTag:function(a,b){if(this.log("_setNodeTag",a,b),a.__JSDOMParser__)return a.localName=b.toLowerCase(),a.tagName=b.toUpperCase(),a;for(var c=a.ownerDocument.createElement(b);a.firstChild;)c.appendChild(a.firstChild);a.parentNode.replaceChild(c,a),a.readability&&(c.readability=a.readability);for(var d=0;d<a.attributes.length;d++)c.setAttribute(a.attributes[d].name,a.attributes[d].value);return c},_prepArticle:function(a){this._cleanStyles(a),this._markDataTables(a),this._cleanConditionally(a,"form"),this._cleanConditionally(a,"fieldset"),this._clean(a,"object"),this._clean(a,"embed"),this._clean(a,"h1"),this._clean(a,"footer"),this._forEachNode(a.children,function(a){this._cleanMatchedNodes(a,/share/)});var b=a.getElementsByTagName("h2");if(1===b.length){var c=(b[0].textContent.length-this._articleTitle.length)/this._articleTitle.length;Math.abs(c)<.5&&(c>0?b[0].textContent.includes(this._articleTitle):this._articleTitle.includes(b[0].textContent))&&this._clean(a,"h2")}this._clean(a,"iframe"),this._clean(a,"input"),this._clean(a,"textarea"),this._clean(a,"select"),this._clean(a,"button"),this._cleanHeaders(a),this._cleanConditionally(a,"table"),this._cleanConditionally(a,"ul"),this._cleanConditionally(a,"div"),this._removeNodes(a.getElementsByTagName("p"),function(a){var b=a.getElementsByTagName("img").length,c=a.getElementsByTagName("embed").length,d=a.getElementsByTagName("object").length,e=a.getElementsByTagName("iframe").length,f=b+c+d+e;return 0===f&&!this._getInnerText(a,!1)}),this._forEachNode(this._getAllNodesWithTag(a,["br"]),function(a){var b=this._nextElement(a.nextSibling);b&&"P"==b.tagName&&a.parentNode.removeChild(a)})},_initializeNode:function(a){switch(a.readability={contentScore:0},a.tagName){case"DIV":a.readability.contentScore+=5;break;case"PRE":case"TD":case"BLOCKQUOTE":a.readability.contentScore+=3;break;case"ADDRESS":case"OL":case"UL":case"DL":case"DD":case"DT":case"LI":case"FORM":a.readability.contentScore-=3;break;case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"TH":a.readability.contentScore-=5}a.readability.contentScore+=this._getClassWeight(a)},_removeAndGetNext:function(a){var b=this._getNextNode(a,!0);return a.parentNode.removeChild(a),b},_getNextNode:function(a,b){if(!b&&a.firstElementChild)return a.firstElementChild;if(a.nextElementSibling)return a.nextElementSibling;do a=a.parentNode;while(a&&!a.nextElementSibling);return a&&a.nextElementSibling},_getNextNodeNoElementProperties:function(a,b){function c(a){do a=a.nextSibling;while(a&&a.nodeType!==a.ELEMENT_NODE);return a}if(!b&&a.children[0])return a.children[0];var d=c(a);if(d)return d;do a=a.parentNode,a&&(d=c(a));while(a&&!d);return a&&d},_checkByline:function(a,b){if(this._articleByline)return!1;if(void 0!==a.getAttribute)var c=a.getAttribute("rel");return!("author"!==c&&!this.REGEXPS.byline.test(b)||!this._isValidByline(a.textContent))&&(this._articleByline=a.textContent.trim(),!0)},_getNodeAncestors:function(a,b){b=b||0;for(var c=0,d=[];a.parentNode&&(d.push(a.parentNode),!b||++c!==b);)a=a.parentNode;return d},_grabArticle:function(a){this.log("**** grabArticle ****");var b=this._doc,c=null!==a;if(a=a?a:this._doc.body,!a)return this.log("No body found in document. Abort."),null;for(var d=a.innerHTML;;){for(var e=this._flagIsActive(this.FLAG_STRIP_UNLIKELYS),f=[],g=this._doc.documentElement;g;){var h=g.className+" "+g.id;if(this._checkByline(g,h))g=this._removeAndGetNext(g);else if(e&&this.REGEXPS.unlikelyCandidates.test(h)&&!this.REGEXPS.okMaybeItsACandidate.test(h)&&"BODY"!==g.tagName&&"A"!==g.tagName)this.log("Removing unlikely candidate - "+h),g=this._removeAndGetNext(g);else if("DIV"!==g.tagName&&"SECTION"!==g.tagName&&"HEADER"!==g.tagName&&"H1"!==g.tagName&&"H2"!==g.tagName&&"H3"!==g.tagName&&"H4"!==g.tagName&&"H5"!==g.tagName&&"H6"!==g.tagName||!this._isElementWithoutContent(g)){if(this.DEFAULT_TAGS_TO_SCORE.indexOf(g.tagName)!==-1&&f.push(g),"DIV"===g.tagName)if(this._hasSinglePInsideElement(g)){var i=g.children[0];g.parentNode.replaceChild(i,g),g=i}else this._hasChildBlockElement(g)?this._forEachNode(g.childNodes,function(a){if(a.nodeType===Node.TEXT_NODE&&a.textContent.trim().length>0){var c=b.createElement("p");c.textContent=a.textContent,c.style.display="inline",c.className="readability-styled",g.replaceChild(c,a)}}):(g=this._setNodeTag(g,"P"),f.push(g));g=this._getNextNode(g)}else g=this._removeAndGetNext(g)}var j=[];this._forEachNode(f,function(a){if(a.parentNode&&"undefined"!=typeof a.parentNode.tagName){var b=this._getInnerText(a);if(!(b.length<25)){var c=this._getNodeAncestors(a,3);if(0!==c.length){var d=0;d+=1,d+=b.split(",").length,d+=Math.min(Math.floor(b.length/100),3),this._forEachNode(c,function(a,b){if(a.tagName){if("undefined"==typeof a.readability&&(this._initializeNode(a),j.push(a)),0===b)var c=1;else c=1===b?2:3*b;a.readability.contentScore+=d/c}})}}}});for(var k=[],l=0,m=j.length;l<m;l+=1){var n=j[l],o=n.readability.contentScore*(1-this._getLinkDensity(n));n.readability.contentScore=o,this.log("Candidate:",n,"with score "+o);for(var p=0;p<this._nbTopCandidates;p++){var q=k[p];if(!q||o>q.readability.contentScore){k.splice(p,0,n),k.length>this._nbTopCandidates&&k.pop();break}}}var r,s=k[0]||null,t=!1;if(null===s||"BODY"===s.tagName){s=b.createElement("DIV"),t=!0;for(var u=a.childNodes;u.length;)this.log("Moving child out:",u[0]),s.appendChild(u[0]);a.appendChild(s),this._initializeNode(s)}else if(s){for(var v=[],w=1;w<k.length;w++)k[w].readability.contentScore/s.readability.contentScore>=.75&&v.push(this._getNodeAncestors(k[w]));var x=3;if(v.length>=x)for(r=s.parentNode;"BODY"!==r.tagName;){for(var y=0,z=0;z<v.length&&y<x;z++)y+=Number(v[z].includes(r));if(y>=x){s=r;break}r=r.parentNode}s.readability||this._initializeNode(s),r=s.parentNode;for(var A=s.readability.contentScore,B=A/3;"BODY"!==r.tagName;)if(r.readability){var C=r.readability.contentScore;if(C<B)break;if(C>A){s=r;break}A=r.readability.contentScore,r=r.parentNode}else r=r.parentNode;for(r=s.parentNode;"BODY"!=r.tagName&&1==r.children.length;)s=r,r=s.parentNode;s.readability||this._initializeNode(s)}var D=b.createElement("DIV");c&&(D.id="readability-content");var E=Math.max(10,.2*s.readability.contentScore);r=s.parentNode;for(var F=r.children,G=0,H=F.length;G<H;G++){var I=F[G],J=!1;if(this.log("Looking at sibling node:",I,I.readability?"with score "+I.readability.contentScore:""),this.log("Sibling has score",I.readability?I.readability.contentScore:"Unknown"),I===s)J=!0;else{var K=0;if(I.className===s.className&&""!==s.className&&(K+=.2*s.readability.contentScore),I.readability&&I.readability.contentScore+K>=E)J=!0;else if("P"===I.nodeName){var L=this._getLinkDensity(I),M=this._getInnerText(I),N=M.length;N>80&&L<.25?J=!0:N<80&&N>0&&0===L&&M.search(/\.( |$)/)!==-1&&(J=!0)}}J&&(this.log("Appending node:",I),this.ALTER_TO_DIV_EXCEPTIONS.indexOf(I.nodeName)===-1&&(this.log("Altering sibling:",I,"to div."),I=this._setNodeTag(I,"DIV")),D.appendChild(I),G-=1,H-=1)}if(this._debug&&this.log("Article content pre-prep: "+D.innerHTML),this._prepArticle(D),this._debug&&this.log("Article content post-prep: "+D.innerHTML),1===this._curPageNum)if(t)s.id="readability-page-1",s.className="page";else{var O=b.createElement("DIV");O.id="readability-page-1",O.className="page";for(var P=D.childNodes;P.length;)O.appendChild(P[0]);D.appendChild(O)}if(this._debug&&this.log("Article content after paging: "+D.innerHTML),!(this._getInnerText(D,!0).length<500)){var Q=[r,s].concat(this._getNodeAncestors(r));return this._someNode(Q,function(a){if(!a.tagName)return!1;var b=a.getAttribute("dir");return!!b&&(this._articleDir=b,!0)}),D}if(a.innerHTML=d,this._flagIsActive(this.FLAG_STRIP_UNLIKELYS))this._removeFlag(this.FLAG_STRIP_UNLIKELYS);else if(this._flagIsActive(this.FLAG_WEIGHT_CLASSES))this._removeFlag(this.FLAG_WEIGHT_CLASSES);else{if(!this._flagIsActive(this.FLAG_CLEAN_CONDITIONALLY))return null;this._removeFlag(this.FLAG_CLEAN_CONDITIONALLY)}}},_isValidByline:function(a){return("string"==typeof a||a instanceof String)&&(a=a.trim(),a.length>0&&a.length<100)},_getArticleMetadata:function(){var a={},b={},c=this._doc.getElementsByTagName("meta"),d=/^\s*((twitter)\s*:\s*)?(description|title)\s*$/gi,e=/^\s*og\s*:\s*(description|title)\s*$/gi;return this._forEachNode(c,function(c){var f=c.getAttribute("name"),g=c.getAttribute("property");if([f,g].indexOf("author")!==-1)return void(a.byline=c.getAttribute("content"));var h=null;if(d.test(f)?h=f:e.test(g)&&(h=g),h){var i=c.getAttribute("content");i&&(h=h.toLowerCase().replace(/\s/g,""),b[h]=i.trim())}}),"description"in b?a.excerpt=b.description:"og:description"in b?a.excerpt=b["og:description"]:"twitter:description"in b&&(a.excerpt=b["twitter:description"]),a.title=this._getArticleTitle(),a.title||("og:title"in b?a.title=b["og:title"]:"twitter:title"in b&&(a.title=b["twitter:title"])),a},_removeScripts:function(a){this._removeNodes(a.getElementsByTagName("script"),function(a){return a.nodeValue="",a.removeAttribute("src"),!0}),this._removeNodes(a.getElementsByTagName("noscript"))},_hasSinglePInsideElement:function(a){return 1==a.children.length&&"P"===a.children[0].tagName&&!this._someNode(a.childNodes,function(a){return a.nodeType===Node.TEXT_NODE&&this.REGEXPS.hasContent.test(a.textContent)})},_isElementWithoutContent:function(a){return a.nodeType===Node.ELEMENT_NODE&&0==a.textContent.trim().length&&(0==a.children.length||a.children.length==a.getElementsByTagName("br").length+a.getElementsByTagName("hr").length)},_hasChildBlockElement:function(a){return this._someNode(a.childNodes,function(a){return this.DIV_TO_P_ELEMS.indexOf(a.tagName)!==-1||this._hasChildBlockElement(a)})},_getInnerText:function(a,b){b="undefined"==typeof b||b;var c=a.textContent.trim();return b?c.replace(this.REGEXPS.normalize," "):c},_getCharCount:function(a,b){return b=b||",",this._getInnerText(a).split(b).length-1},_cleanStyles:function(a){if(a=a||this._doc){var b=a.firstChild;for("function"==typeof a.removeAttribute&&"readability-styled"!==a.className&&a.removeAttribute("style");null!==b;)b.nodeType===b.ELEMENT_NODE&&("readability-styled"!==b.className&&b.removeAttribute("style"),this._cleanStyles(b)),b=b.nextSibling}},_getLinkDensity:function(a){var b=this._getInnerText(a).length;if(0===b)return 0;var c=0;return this._forEachNode(a.getElementsByTagName("a"),function(a){c+=this._getInnerText(a).length}),c/b},_findBaseUrl:function(){for(var a=this._uri,b=a.path.split("?")[0],c=b.split("/").reverse(),d=[],e="",f=0,g=c.length;f<g;f+=1){var h=c[f];h.indexOf(".")!==-1&&(e=h.split(".")[1],e.match(/[^a-zA-Z]/)||(h=h.split(".")[0])),!h.match(/((_|-)?p[a-z]*|(_|-))[0-9]{1,2}$/i)||1!==f&&0!==f||(h=h.replace(/((_|-)?p[a-z]*|(_|-))[0-9]{1,2}$/i,""));var i=!1;f<2&&h.match(/^\d{1,2}$/)&&(i=!0),0===f&&"index"===h.toLowerCase()&&(i=!0),f<2&&h.length<3&&!c[0].match(/[a-z]/i)&&(i=!0),i||d.push(h)}return a.scheme+"://"+a.host+d.reverse().join("/")},_findNextPageLink:function(a){for(var b=this._uri,c={},d=a.getElementsByTagName("a"),e=this._findBaseUrl(),f=0,g=d.length;f<g;f+=1){var h=d[f],i=d[f].href.replace(/#.*$/,"").replace(/\/$/,"");if(!(""===i||i===e||i===b.spec||i in this._parsedPages)&&b.host===i.split(/\/+/g)[1]){var j=this._getInnerText(h);if(!(j.match(this.REGEXPS.extraneous)||j.length>25)){var k=i.replace(e,"");if(k.match(/\d/)){i in c?c[i].linkText+=" | "+j:c[i]={score:0,linkText:j,href:i};var l=c[i];0!==i.indexOf(e)&&(l.score-=25);var m=j+" "+h.className+" "+h.id;m.match(this.REGEXPS.nextLink)&&(l.score+=50),m.match(/pag(e|ing|inat)/i)&&(l.score+=25),m.match(/(first|last)/i)&&(l.linkText.match(this.REGEXPS.nextLink)||(l.score-=65)),(m.match(this.REGEXPS.negative)||m.match(this.REGEXPS.extraneous))&&(l.score-=50),m.match(this.REGEXPS.prevLink)&&(l.score-=200);for(var n=h.parentNode,o=!1,p=!1;n;){var q=n.className+" "+n.id;!o&&q&&q.match(/pag(e|ing|inat)/i)&&(o=!0,l.score+=25),!p&&q&&q.match(this.REGEXPS.negative)&&(q.match(this.REGEXPS.positive)||(l.score-=25,p=!0)),n=n.parentNode}(i.match(/p(a|g|ag)?(e|ing|ination)?(=|\/)[0-9]{1,2}/i)||i.match(/(page|paging)/i))&&(l.score+=25),i.match(this.REGEXPS.extraneous)&&(l.score-=15);var r=parseInt(j,10);r&&(1===r?l.score-=10:l.score+=Math.max(0,10-r))}}}}var s=null;for(var t in c)c.hasOwnProperty(t)&&c[t].score>=50&&(!s||s.score<c[t].score)&&(s=c[t]);var u=null;return s&&(u=s.href.replace(/\/$/,""),this.log("NEXT PAGE IS "+u),this._parsedPages[u]=!0),u},_successfulRequest:function(a){return a.status>=200&&a.status<300||304===a.status||0===a.status&&a.responseText},_ajax:function(a,b){function c(a){4===d.readyState&&(this._successfulRequest(d)?b.success&&b.success(d):b.error&&b.error(d))}var d=new XMLHttpRequest;"undefined"==typeof b&&(b={}),d.onreadystatechange=c,d.open("get",a,!0),d.setRequestHeader("Accept","text/html");try{d.send(b.postBody)}catch(a){b.error&&b.error()}return d},_appendNextPage:function(a){var b=this._doc;this._curPageNum+=1;var c=b.createElement("DIV");if(c.id="readability-page-"+this._curPageNum,c.className="page",c.innerHTML='<p class="page-separator" title="Page '+this._curPageNum+'">&sect;</p>',b.getElementById("readability-content").appendChild(c),this._curPageNum>this._maxPages){var d="<div style='text-align: center'><a href='"+a+"'>View Next Page</a></div>";return void(c.innerHTML=c.innerHTML+d)}(function(a,d){this._ajax(a,{success:function(e){var f=e.getResponseHeader("ETag");if(f){if(f in this._pageETags)return this.log("Exact duplicate page found via ETag. Aborting."),void(c.style.display="none");this._pageETags[f]=1}var g=b.createElement("DIV"),h=e.responseText.replace(/\n/g,"￿").replace(/<script.*?>.*?<\/script>/gi,"");h=h.replace(/\n/g,"￿").replace(/<script.*?>.*?<\/script>/gi,""),h=h.replace(/\uffff/g,"\n").replace(/<(\/?)noscript/gi,"<$1div"),h=h.replace(this.REGEXPS.replaceFonts,"<$1span>"),g.innerHTML=h,this._replaceBrs(g),this._flags=7;var i=this._findNextPageLink(g),j=this._grabArticle(g);if(!j)return void this.log("No content found in page to append. Aborting.");var k=j.getElementsByTagName("P").length?j.getElementsByTagName("P")[0]:null;if(k&&k.innerHTML.length>100)for(var l=1;l<=this._curPageNum;l+=1){var m=b.getElementById("readability-page-"+l);if(m&&m.innerHTML.indexOf(k.innerHTML)!==-1)return this.log("Duplicate of page "+l+" - skipping."),c.style.display="none",void(this._parsedPages[a]=!0)}this._removeScripts(j),d.innerHTML=d.innerHTML+j.innerHTML,setTimeout(function(){this._postProcessContent(d)}.bind(this),500),i&&this._appendNextPage(i)}})}).bind(this)(a,c)},_getClassWeight:function(a){if(!this._flagIsActive(this.FLAG_WEIGHT_CLASSES))return 0;var b=0;return"string"==typeof a.className&&""!==a.className&&(this.REGEXPS.negative.test(a.className)&&(b-=25),this.REGEXPS.positive.test(a.className)&&(b+=25)),"string"==typeof a.id&&""!==a.id&&(this.REGEXPS.negative.test(a.id)&&(b-=25),this.REGEXPS.positive.test(a.id)&&(b+=25)),b},_clean:function(a,b){var c=["object","embed","iframe"].indexOf(b)!==-1;this._removeNodes(a.getElementsByTagName(b),function(a){if(c){var b=[].map.call(a.attributes,function(a){return a.value}).join("|");if(this.REGEXPS.videos.test(b))return!1;if(this.REGEXPS.videos.test(a.innerHTML))return!1}return!0})},_hasAncestorTag:function(a,b,c,d){c=c||3,b=b.toUpperCase();for(var e=0;a.parentNode;){if(c>0&&e>c)return!1;if(a.parentNode.tagName===b&&(!d||d(a.parentNode)))return!0;a=a.parentNode,e++}return!1},_getRowAndColumnCount:function(a){for(var b=0,c=0,d=a.getElementsByTagName("tr"),e=0;e<d.length;e++){var f=d[e].getAttribute("rowspan")||0;f&&(f=parseInt(f,10)),b+=f||1;for(var g=0,h=d[e].getElementsByTagName("td"),i=0;i<h.length;i++){var j=h[i].getAttribute("colspan")||0;j&&(j=parseInt(j,10)),g+=j||1}c=Math.max(c,g)}return{rows:b,columns:c}},_markDataTables:function(a){for(var b=a.getElementsByTagName("table"),c=0;c<b.length;c++){var d=b[c],e=d.getAttribute("role");if("presentation"!=e){var f=d.getAttribute("datatable");if("0"!=f){var g=d.getAttribute("summary");if(g)d._readabilityDataTable=!0;else{var h=d.getElementsByTagName("caption")[0];if(h&&h.childNodes.length>0)d._readabilityDataTable=!0;else{var i=["col","colgroup","tfoot","thead","th"],j=function(a){return!!d.getElementsByTagName(a)[0]};if(i.some(j))this.log("Data table because found data-y descendant"),d._readabilityDataTable=!0;else if(d.getElementsByTagName("table")[0])d._readabilityDataTable=!1;else{var k=this._getRowAndColumnCount(d);k.rows>=10||k.columns>4?d._readabilityDataTable=!0:d._readabilityDataTable=k.rows*k.columns>10}}}}else d._readabilityDataTable=!1}else d._readabilityDataTable=!1}},_cleanConditionally:function(a,b){if(this._flagIsActive(this.FLAG_CLEAN_CONDITIONALLY)){var c="ul"===b||"ol"===b;this._removeNodes(a.getElementsByTagName(b),function(a){var b=function(a){return a._readabilityDataTable};if(this._hasAncestorTag(a,"table",-1,b))return!1;var d=this._getClassWeight(a),e=0;if(this.log("Cleaning Conditionally",a),d+e<0)return!0;if(this._getCharCount(a,",")<10){for(var f=a.getElementsByTagName("p").length,g=a.getElementsByTagName("img").length,h=a.getElementsByTagName("li").length-100,i=a.getElementsByTagName("input").length,j=0,k=a.getElementsByTagName("embed"),l=0,m=k.length;l<m;l+=1)this.REGEXPS.videos.test(k[l].src)||(j+=1);var n=this._getLinkDensity(a),o=this._getInnerText(a).length,p=g>1&&f/g<.5&&!this._hasAncestorTag(a,"figure")||!c&&h>f||i>Math.floor(f/3)||!c&&o<25&&(0===g||g>2)&&!this._hasAncestorTag(a,"figure")||!c&&d<25&&n>.2||d>=25&&n>.5||1===j&&o<75||j>1;return p}return!1})}},_cleanMatchedNodes:function(a,b){for(var c=this._getNextNode(a,!0),d=this._getNextNode(a);d&&d!=c;)d=b.test(d.className+" "+d.id)?this._removeAndGetNext(d):this._getNextNode(d)},_cleanHeaders:function(a){for(var b=1;b<3;b+=1)this._removeNodes(a.getElementsByTagName("h"+b),function(a){return this._getClassWeight(a)<0})},_flagIsActive:function(a){return(this._flags&a)>0},_addFlag:function(a){this._flags=this._flags|a},_removeFlag:function(a){this._flags=this._flags&~a},isProbablyReaderable:function(a){var b=this._getAllNodesWithTag(this._doc,["p","pre"]),c=this._getAllNodesWithTag(this._doc,["div > br"]);if(c.length){var d=new Set;[].forEach.call(c,function(a){d.add(a.parentNode)}),b=[].concat.apply(Array.from(d),b)}var e=0;return this._someNode(b,function(b){if(a&&!a(b))return!1;var c=b.className+" "+b.id;if(this.REGEXPS.unlikelyCandidates.test(c)&&!this.REGEXPS.okMaybeItsACandidate.test(c))return!1;if(b.matches&&b.matches("li p"))return!1;var d=b.textContent.trim().length;return!(d<140)&&(e+=Math.sqrt(d-140),e>20)})},parse:function(){if(this._maxElemsToParse>0){var a=this._doc.getElementsByTagName("*").length;if(a>this._maxElemsToParse)throw new Error("Aborting parsing document; "+a+" elements found")}"undefined"==typeof this._doc.documentElement.firstElementChild&&(this._getNextNode=this._getNextNodeNoElementProperties),this._removeScripts(this._doc),this._prepDocument();var b=this._getArticleMetadata();this._articleTitle=b.title;var c=this._grabArticle();if(!c)return null;if(this.log("Grabbed: "+c.innerHTML),this._postProcessContent(c),!b.excerpt){var d=c.getElementsByTagName("p");d.length>0&&(b.excerpt=d[0].textContent.trim())}var e=c.textContent;return{uri:this._uri,title:this._articleTitle,byline:b.byline||this._articleByline,dir:this._articleDir,content:c.innerHTML,textContent:e,length:e.length,excerpt:b.excerpt}}},"object"==typeof module&&(module.exports=ta);